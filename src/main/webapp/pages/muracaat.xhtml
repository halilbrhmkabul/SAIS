<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="jakarta.faces.core">

<ui:composition template="/templates/layout.xhtml">
    
    <ui:define name="title">M√ºracaat ƒ∞≈ülemleri - SAIS</ui:define>
    
    <ui:define name="pageTitle">M√ºracaat ƒ∞≈ülemleri</ui:define>
    
    <ui:define name="content">
        <p:growl id="growl" showDetail="true" life="5000" sticky="false"/>
        
        <h:form id="mainForm" enctype="multipart/form-data">
            <!-- Breadcrumb -->
            <div class="content-header">
                <div class="content-breadcrumb">
                    <span>Ana Sayfa</span>
                    <span class="breadcrumb-separator">/</span>
                    <span>M√ºracaat ƒ∞≈ülemleri</span>
                </div>
            </div>
        
        <!-- ƒ∞statistik Kartlarƒ± -->
        <h:panelGroup id="statsCards" layout="block" styleClass="stats-grid">
            <div class="stat-card">
                <div class="stat-title">Bekleyen M√ºracaatlar</div>
                <div class="stat-value">
                    #{muracaatController.bekleyenMuracaatSayisi}
                    <i class="fas fa-clock stat-icon"></i>
                </div>
            </div>
            
            <div class="stat-card success">
                <div class="stat-title">Sonu√ßlanan</div>
                <div class="stat-value">
                    #{muracaatController.sonuclananMuracaatSayisi}
                    <i class="fas fa-check-circle stat-icon"></i>
                </div>
            </div>
            
            <div class="stat-card warning">
                <div class="stat-title">Tahkikatta</div>
                <div class="stat-value">
                    #{muracaatController.tahkikattaMuracaatSayisi}
                    <i class="fas fa-search stat-icon"></i>
                </div>
            </div>
            
            <div class="stat-card error">
                <div class="stat-title">Red Edilenler</div>
                <div class="stat-value">
                    0
                    <i class="fas fa-times-circle stat-icon"></i>
                </div>
            </div>
        </h:panelGroup>
        
        <!-- Ana ƒ∞√ßerik -->
        <div class="content-body">
                
                <!-- Toolbar -->
                <p:toolbar id="toolbar" style="margin-bottom: 20px;">
                    <p:toolbarGroup>
                        <p:commandButton value="Yeni M√ºracaat" 
                                       icon="pi pi-plus" 
                                       styleClass="ui-button-success"
                                       action="#{muracaatController.newMuracaat}" 
                                       update="@form tabView" 
                                       process="@this"
                                       resetValues="true"/>
                        
                        <p:commandButton value="M√ºracaatlar" 
                                       icon="pi pi-list" 
                                       styleClass="ui-button-info"
                                       action="#{muracaatController.tumMuracaatlariGoster}" 
                                       update="tumMuracaatlarTable" 
                                       process="@this"
                                       oncomplete="PF('tumMuracaatlarDialogVar').show();"
                                       title="Tamamlanan ve bekleyen m√ºracaatlarƒ± g√∂ster"/>
                    </p:toolbarGroup>
                    
                    <p:toolbarGroup align="right">
                        <h:panelGroup rendered="#{not empty muracaatController.selectedMuracaat}">
                            <p:outputLabel value="Durum: " style="font-weight:bold; margin-right:10px;"/>
                            <p:badge id="durumBadge" 
                                   value="#{muracaatController.selectedMuracaat.durum.label}" 
                                   severity="#{muracaatController.selectedMuracaat.durum eq 'SONUCLANDI' ? 'success' : 'warning'}"/>
                        </h:panelGroup>
                    </p:toolbarGroup>
                </p:toolbar>
                
                <!-- Tab View - Adƒ±m Adƒ±m ƒ∞lerleme -->
                <h:panelGroup rendered="#{not empty muracaatController.selectedMuracaat}">
                <p:tabView id="tabView" 
                          widgetVar="tabViewWidget"
                          activeIndex="#{muracaatController.activeTabIndex}" 
                          dynamic="true" 
                          cache="false">
                    <p:ajax event="tabChange" listener="#{muracaatController.onTabChange}"/>
                    
                    <!-- 1. M√úRACAAT Bƒ∞LGƒ∞LERƒ∞ TAB -->
                    <p:tab title="1. Ba≈üvuru Bilgileri" icon="pi pi-file-edit" disabled="false">
                        <div class="card">
                            <h3 class="card-header">
                                <i class="fas fa-file-alt"></i> M√ºracaat Bilgileri
                            </h3>
                            
                            <h:panelGroup id="basvuruBilgileriPanel">
                            <div class="card-body">
                                <!-- Temel Bilgiler -->
                                <p:panel header="Temel Bilgiler" style="margin-bottom: 20px;">
                                    <div class="form-grid">
                                        <!-- M√ºracaat Tarihi -->
                                        <div class="form-field">
                                            <p:outputLabel for="muracaatTarihi" value="M√ºracaat Tarihi" styleClass="required"/>
                                            <p:calendar id="muracaatTarihi" 
                                                      value="#{muracaatController.selectedMuracaat.muracaatTarihi}"
                                                      pattern="dd/MM/yyyy"
                                                      showIcon="true"
                                                      required="true"
                                                      requiredMessage="M√ºracaat tarihi zorunludur"/>
                                        </div>
                                        
                                        <!-- Komisyon Kararlƒ± mƒ±? -->
                                        <div class="form-field">
                                            <p:outputLabel for="komisyonKararli" value="Komisyon Kararlƒ± mƒ±?" styleClass="required"/>
                                            <p:selectBooleanCheckbox id="komisyonKararli" 
                                                                    value="#{muracaatController.komisyonKararli}">
                                                <p:ajax event="change" 
                                                       listener="#{muracaatController.onKomisyonKararliChange}"
                                                       update="yardimTalepleriContainer"/>
                                            </p:selectBooleanCheckbox>
                                            <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                                                <i class="fas fa-info-circle"></i> 
                                                ƒ∞≈üaretlenirse komisyon kararƒ± ile verilecek yardƒ±mlar da listelenir
                                            </small>
                                        </div>
                                    </div>
                                </p:panel>
                                
                                <!-- Ba≈üvuru Sahibi Bilgileri -->
                                <p:panel header="Ba≈üvuru Sahibi Bilgileri" style="margin-bottom: 20px;">
                                    <div class="form-grid">
                                        <!-- Kendisi mi Ba≈üvurdu? -->
                                        <div class="form-field" style="grid-column: 1 / -1;">
                                            <p:outputLabel for="kendisiBasvurdu" value="Ba≈üvuruyu Kimlik Sahibi mi Yaptƒ±?" styleClass="required"/>
                                            <div style="display: flex; align-items: center; gap: 10px;">
                                            <p:selectBooleanCheckbox id="kendisiBasvurdu" 
                                                                    value="#{muracaatController.kendisiBasvurdu}">
                                                    <p:ajax event="change" update="adinaBasvurulanPanel tcKimlikNoLabel"/>
                                            </p:selectBooleanCheckbox>
                                                <span style="font-weight: 500;">
                                                    #{muracaatController.kendisiBasvurdu ? '‚úÖ Evet, kendisi ba≈üvurdu' : '‚ùå Hayƒ±r, ba≈üka biri adƒ±na'}
                                                </span>
                                            </div>
                                            <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                                                <i class="fas fa-info-circle"></i> 
                                                ƒ∞≈üaretlenirse ba≈üvuru sahibi kendisidir, i≈üaretlenmezse ba≈üka biri adƒ±na ba≈üvuru yapƒ±lmƒ±≈ütƒ±r
                                            </small>
                                        </div>
                                        
                                        <!-- TC Kimlik No (Ba≈üvuru Sahibi) -->
                                        <div class="form-field" style="grid-column: 1 / -1;">
                                            <h:panelGroup id="tcKimlikNoLabel">
                                            <p:outputLabel for="tcKimlikNo" 
                                                             value="#{muracaatController.kendisiBasvurdu ? 'Ba≈üvuru Sahibi (Kendisi) TC No' : 'Ba≈üvuruyu Yapan Ki≈üinin TC No'}" 
                                                         styleClass="required"/>
                                                <small style="display: block; margin-bottom: 5px; color: var(--text-secondary);">
                                                    #{muracaatController.kendisiBasvurdu ? 
                                                        'üí° Ba≈üvuru sahibinin kendi TC kimlik numarasƒ±' : 
                                                        'üí° Ba≈üka biri adƒ±na ba≈üvuru yapan ki≈üinin TC kimlik numarasƒ±'}
                                                </small>
                                            </h:panelGroup>
                                            <div style="display: flex; gap: 10px;">
                                                <p:inputText id="tcKimlikNo" 
                                                           value="#{muracaatController.tcKimlikNo}"
                                                           placeholder="TC Kimlik No (11 hane)"
                                                           maxlength="11"
                                                           required="true"
                                                           style="flex: 1;"/>
                                                <p:commandButton value="MERNƒ∞S Sorgula" 
                                                               icon="pi pi-search" 
                                                               styleClass="ui-button-info"
                                                               action="#{muracaatController.mernistenKisiSorgula}" 
                                                               update="mainForm growl" 
                                                               process="@this,tcKimlikNo"/>
                                            </div>
                                        </div>
                                        
                                        
                                        <h:panelGroup rendered="#{muracaatController.selectedMuracaat.basvuruSahibi ne null and muracaatController.selectedMuracaat.basvuruSahibi.id ne null}">
                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                <div style="padding: 15px; background: #E8F5E9; border: 2px solid #4CAF50; border-radius: 8px; margin-top: 10px;">
                                                    <h4 style="margin: 0 0 15px 0; color: #2E7D32;">
                                                        <i class="fas fa-user-check"></i> 
                                                        #{muracaatController.kendisiBasvurdu ? 'Ba≈üvuru Sahibi (Kendisi) - MERNƒ∞S Bilgileri' : 'Ba≈üvuruyu Yapan Ki≈üi - MERNƒ∞S Bilgileri'}
                                                    </h4>
                                                    <div class="form-grid">
                                                        <!-- Ad Soyad -->
                                            <div class="form-field">
                                                <p:outputLabel value="Ad Soyad"/>
                                                <p:inputText value="#{muracaatController.selectedMuracaat.basvuruSahibi.ad} #{muracaatController.selectedMuracaat.basvuruSahibi.soyad}"
                                                           disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                            </div>
                                            
                                                        <!-- Doƒüum Tarihi -->
                                            <div class="form-field">
                                                <p:outputLabel value="Doƒüum Tarihi"/>
                                                <p:inputText value="#{muracaatController.selectedMuracaat.basvuruSahibi.dogumTarihi}"
                                                           disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                                        </div>
                                                        
                                                        <!-- TC Kimlik No -->
                                                        <div class="form-field">
                                                            <p:outputLabel value="TC Kimlik No"/>
                                                            <p:inputText value="#{muracaatController.selectedMuracaat.basvuruSahibi.tcKimlikNo}"
                                                                       disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                                        </div>
                                                        
                                                        <!-- Gebze ƒ∞kameti -->
                                                        <div class="form-field">
                                                            <p:outputLabel value="Gebze ƒ∞kameti"/>
                                                            <p:badge value="#{muracaatController.selectedMuracaat.basvuruSahibi.gebzeIkameti ? 'Gebze' : 'Gebze Dƒ±≈üƒ±'}"
                                                                    severity="#{muracaatController.selectedMuracaat.basvuruSahibi.gebzeIkameti ? 'success' : 'danger'}"
                                                                    size="large"/>
                                            </div>
                                            
                                                        <!-- Adres veya Uyarƒ± -->
                                                        <h:panelGroup rendered="#{muracaatController.selectedMuracaat.basvuruSahibi.gebzeIkameti}">
                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                <p:outputLabel value="Adres"/>
                                                <p:inputTextarea value="#{muracaatController.selectedMuracaat.basvuruSahibi.adres}"
                                                               disabled="true"
                                                                               rows="2"
                                                                               style="background: white;"/>
                                            </div>
                                                        </h:panelGroup>
                                            
                                                        <h:panelGroup rendered="#{not muracaatController.selectedMuracaat.basvuruSahibi.gebzeIkameti}">
                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                                <div style="padding: 12px; background: #FFEBEE; border: 2px solid #f44336; border-radius: 8px; text-align: center;">
                                                                    <i class="fas fa-exclamation-triangle" style="color: #c62828; font-size: 20px;"></i>
                                                                    <p style="margin: 8px 0 0 0; color: #c62828; font-weight: 600;">
                                                                        ‚ö†Ô∏è GEBZE DI≈ûINDA ƒ∞KAMET - BA≈ûVURU KABUL EDƒ∞LMEZ!
                                                                    </p>
                                                                </div>
                                                            </div>
                                                </h:panelGroup>
                                                    </div>
                                                </div>
                                            </div>
                                        </h:panelGroup>
                                    </div>
                                </p:panel>
                                
                                <!-- Adƒ±na Ba≈üvurulan Ki≈üi (Kendisi ba≈üvurmadƒ±ysa) -->
                                <h:panelGroup id="adinaBasvurulanPanel">
                                    <p:panel header="‚ö†Ô∏è Adƒ±na Ba≈üvurulan Ki≈üi (Asƒ±l Ba≈üvuru Sahibi)" 
                                        rendered="#{not muracaatController.kendisiBasvurdu}"
                                            style="margin-bottom: 20px; border-left: 4px solid #FF9800;">
                                        <div style="padding: 10px; background: #FFF3E0; border-radius: 4px; margin-bottom: 15px;">
                                            <i class="fas fa-info-circle" style="color: #FF9800;"></i>
                                            <strong> Dikkat:</strong> Ba≈üvuruyu ba≈üka biri yaptƒ±ƒüƒ± i√ßin, 
                                            <strong>asƒ±l yardƒ±m alacak ki≈üinin</strong> bilgilerini giriniz.
                                        </div>
                                        
                                    <div class="form-grid">
                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                <p:outputLabel for="adinaBasvurulanTc" 
                                                             value="Asƒ±l Ba≈üvuru Sahibi (Yardƒ±m Alacak Ki≈üi) TC No" 
                                                             styleClass="required"/>
                                                <small style="display: block; margin-bottom: 5px; color: var(--text-secondary);">
                                                    üí° Yardƒ±mdan faydalanacak asƒ±l ki≈üinin TC kimlik numarasƒ±
                                                </small>
                                            <div style="display: flex; gap: 10px;">
                                                <p:inputText id="adinaBasvurulanTc" 
                                                           value="#{muracaatController.adinaBasvurulanTcNo}"
                                                           placeholder="TC Kimlik No (11 hane)"
                                                           maxlength="11"
                                                           required="#{not muracaatController.kendisiBasvurdu}"
                                                           style="flex: 1;"/>
                                                    <p:commandButton value="MERNƒ∞S Sorgula" 
                                                               icon="pi pi-search" 
                                                                   styleClass="ui-button-warning"
                                                               action="#{muracaatController.adinaBasvurulanKisiSorgula}" 
                                                               update="mainForm growl" 
                                                               process="@this,adinaBasvurulanTc"/>
                                            </div>
                                        </div>
                                        
                                        <!-- Adƒ±na Ba≈üvurulan Ki≈üi Bilgileri -->
                                            <h:panelGroup rendered="#{not empty muracaatController.selectedMuracaat.adinaBasvurulanKisi}"
                                                         style="grid-column: 1 / -1;">
                                                <div style="padding: 15px; background: #E8F5E9; border: 2px solid #4CAF50; border-radius: 8px; margin-top: 10px;">
                                                    <h4 style="margin: 0 0 10px 0; color: #2E7D32;">
                                                        ‚úÖ Asƒ±l Ba≈üvuru Sahibi (Yardƒ±m Alacak Ki≈üi)
                                                    </h4>
                                                    <div class="form-grid">
                                            <div class="form-field">
                                                <p:outputLabel value="Ad Soyad"/>
                                                <p:inputText value="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.ad} #{muracaatController.selectedMuracaat.adinaBasvurulanKisi.soyad}"
                                                           disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                                        </div>
                                                        
                                                        <div class="form-field">
                                                            <p:outputLabel value="TC Kimlik No"/>
                                                            <p:inputText value="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.tcKimlikNo}"
                                                                       disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                                        </div>
                                                        
                                                        <div class="form-field">
                                                            <p:outputLabel value="Doƒüum Tarihi"/>
                                                            <p:inputText value="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.dogumTarihi}"
                                                                       disabled="true"
                                                                       style="font-weight: 600; background: white;"/>
                                                        </div>
                                                        
                                                        <!-- Gebze ƒ∞kameti -->
                                                        <div class="form-field">
                                                            <p:outputLabel value="Gebze ƒ∞kameti"/>
                                                            <p:badge value="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.gebzeIkameti ? 'Gebze' : 'Gebze Dƒ±≈üƒ±'}"
                                                                    severity="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.gebzeIkameti ? 'success' : 'danger'}"
                                                                    size="large"/>
                                                        </div>
                                                        
                                                        <!-- Adres veya Uyarƒ± -->
                                                        <h:panelGroup rendered="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.gebzeIkameti}">
                                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                                <p:outputLabel value="Adres"/>
                                                                <p:inputTextarea value="#{muracaatController.selectedMuracaat.adinaBasvurulanKisi.adres}"
                                                                               disabled="true"
                                                                               rows="2"
                                                                               style="background: white;"/>
                                                            </div>
                                                        </h:panelGroup>
                                                        
                                                        <h:panelGroup rendered="#{not muracaatController.selectedMuracaat.adinaBasvurulanKisi.gebzeIkameti}">
                                                            <div class="form-field" style="grid-column: 1 / -1;">
                                                                <div style="padding: 12px; background: #FFEBEE; border: 2px solid #f44336; border-radius: 8px; text-align: center;">
                                                                    <i class="fas fa-exclamation-triangle" style="color: #c62828; font-size: 20px;"></i>
                                                                    <p style="margin: 8px 0 0 0; color: #c62828; font-weight: 600;">
                                                                        ‚ö†Ô∏è GEBZE DI≈ûINDA ƒ∞KAMET - BA≈ûVURU KABUL EDƒ∞LMEZ!
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </h:panelGroup>
                                                    </div>
                                            </div>
                                        </h:panelGroup>
                                    </div>
                                </p:panel>
                                </h:panelGroup>
                                
                                <!-- Ba≈üvuru Detaylarƒ± -->
                                <p:panel header="Ba≈üvuru Detaylarƒ±" style="margin-bottom: 20px;">
                                    <div class="form-grid">
                                        <!-- Ba≈üvuru Metni -->
                                        <div class="form-field" style="grid-column: 1 / -1;">
                                            <p:outputLabel for="basvuruMetni" value="Ba≈üvuru Metni" styleClass="required"/>
                                            <p:inputTextarea id="basvuruMetni" 
                                                           value="#{muracaatController.basvuruMetni}"
                                                           rows="6"
                                                           maxlength="1000"
                                                           counter="charCounter"
                                                           counterTemplate="{0} karakter kaldƒ±"
                                                           required="true"
                                                           requiredMessage="Ba≈üvuru metni girilmelidir (en az 10 karakter)"
                                                           placeholder="Ba≈üvuru sahibinin talebini ve durumunu detaylƒ±ca yazƒ±nƒ±z... (En az 10 karakter)"/>
                                            <h:outputText id="charCounter" 
                                                         style="display: block; text-align: right; margin-top: 8px; font-size: 13px; 
                                                                color: #6c757d; font-weight: 500; padding: 5px 10px; 
                                                                background: #f8f9fa; border-radius: 4px;"/>
                                        </div>
                                        
                                        <!-- Personel G√∂r√º≈ü Notu -->
                                        <div class="form-field" style="grid-column: 1 / -1;">
                                            <p:outputLabel for="personelNotu" value="Personel G√∂r√º≈ü Notu"/>
                                            <p:inputTextarea id="personelNotu" 
                                                           value="#{muracaatController.personelGorusNotu}"
                                                           rows="4"
                                                           maxlength="500"
                                                           placeholder="Sosyal inceleme yapan personelin deƒüerlendirme notu..."/>
                                        </div>
                                        
                                        <!-- Dok√ºman Y√∂netimi -->
                                        <div class="form-field" style="grid-column: 1 / -1;">
                                            <p:outputLabel value="Dok√ºman Y√∂netimi" style="font-weight: 600; font-size: 16px; display: block; margin-bottom: 15px;"/>
                                            
                                            <h:panelGroup id="dokumanYonetimPanel">
                                                <!-- Dosya Y√ºkleme Alanƒ± -->
                                                <p:panel header="üìé Yeni Dok√ºman Y√ºkle" 
                                                        style="margin-bottom: 20px;"
                                                        toggleable="true"
                                                        collapsed="#{not empty muracaatController.selectedMuracaat.id}">
                                                    
                                                    <!-- Bilgilendirme -->
                                                    <div style="padding: 10px; background: #E3F2FD; border-left: 4px solid #2196F3; margin-bottom: 15px; border-radius: 4px;">
                                                        <i class="fas fa-info-circle" style="color: #2196F3;"></i>
                                                        <strong> Bilgi:</strong>
                                                        <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                                                            <li>ƒ∞zin verilen dosya t√ºrleri: <strong>PDF, DOC, DOCX, JPG, PNG, XLS, XLSX</strong></li>
                                                            <li>Maksimum dosya boyutu: <strong>10 MB</strong></li>
                                                            <li>Birden fazla dosya y√ºkleyebilirsiniz</li>
                                                            <li><strong>Dosyalarƒ± √∂nce se√ßin, sonra "Kaydet ve Devam Et" butonuna basƒ±n</strong></li>
                                                            <li>Dosyalar <strong>#{muracaatController.selectedMuracaat.basvuruSahibi ne null ? muracaatController.selectedMuracaat.basvuruSahibi.ad : 'Ba≈üvuru Sahibi'}_#{muracaatController.selectedMuracaat.basvuruSahibi ne null ? muracaatController.selectedMuracaat.basvuruSahibi.soyad : 'Soyad'}</strong> klas√∂r√ºne kaydedilecek</li>
                                                        </ul>
                                                    </div>
                                                    
                                                    <!-- Ge√ßici Dosyalar Bilgisi -->
                                                    <h:panelGroup rendered="#{muracaatDokumanController.geciciDosyaSayisi > 0}">
                                                        <div style="padding: 10px; background: #FFF3E0; border-left: 4px solid #FF9800; margin-bottom: 15px; border-radius: 4px;">
                                                            <i class="fas fa-clock" style="color: #FF9800;"></i>
                                                            <strong> #{muracaatDokumanController.geciciDosyaSayisi} dosya eklendi</strong> - 
                                                            "Kaydet ve Devam Et" butonuna basƒ±nca y√ºklenecek
                                                        </div>
                                                    </h:panelGroup>
                                                    
                                                    <!-- Dosya Y√ºkleme Bile≈üeni -->
                                                    <p:fileUpload 
                                                        listener="#{muracaatDokumanController.handleFileUpload}"
                                                        mode="advanced" 
                                                        auto="true"
                                                        multiple="true"
                                                        dragDropSupport="true"
                                                        label="Dosya Se√ß"
                                                        uploadLabel="Y√ºkle"
                                                        cancelLabel="ƒ∞ptal"
                                                        chooseIcon="pi pi-file"
                                                        uploadIcon="pi pi-upload"
                                                        cancelIcon="pi pi-times"
                                                        allowTypes="/(\.|\/)(pdf|doc|docx|jpg|jpeg|png|gif|xls|xlsx|txt)$/"
                                                        maxFileSize="10485760"
                                                        invalidFileMessage="Ge√ßersiz dosya t√ºr√º! Sadece PDF, DOC, DOCX, JPG, PNG, XLS, XLSX, TXT dosyalarƒ± y√ºkleyebilirsiniz."
                                                        fileLimitMessage="Maksimum dosya boyutu 10MB'dƒ±r!"
                                                        update="dokumanTable growl"
                                                        onupload="console.log('Dosya y√ºklendi!');"
                                                        styleClass="custom-upload"/>
                                                </p:panel>
                                                
                                                <!-- Y√ºkl√º Dok√ºmanlar Listesi -->
                                                <p:panel header="üìÑ Y√ºkl√º Dok√ºmanlar" 
                                                        style="margin-bottom: 20px;"
                                                        rendered="#{not empty muracaatController.selectedMuracaat.id}">
                                                    <p:dataTable id="dokumanTable" 
                                                                value="#{muracaatDokumanController.dokumanList}" 
                                                                var="dokuman"
                                                                emptyMessage="Hen√ºz dok√ºman y√ºklenmemi≈ü."
                                                                paginator="true"
                                                                rows="10"
                                                                paginatorPosition="bottom"
                                                                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                                                currentPageReportTemplate="üìÑ Toplam {totalRecords} dok√ºman (G√∂sterilen: {startRecord}-{endRecord})"
                                                                rowsPerPageTemplate="5,10,15"
                                                                styleClass="custom-datatable">
                                                        
                                                        <!-- Dosya ƒ∞konu -->
                                                        <p:column style="width: 50px; text-align: center;">
                                                            <i class="fas fa-file-#{dokuman.dosyaTipi.contains('pdf') ? 'pdf' : 
                                                                                    dokuman.dosyaTipi.contains('word') ? 'word' : 
                                                                                    dokuman.dosyaTipi.contains('excel') ? 'excel' : 
                                                                                    dokuman.dosyaTipi.contains('image') ? 'image' : 'alt'}" 
                                                               style="font-size: 24px; color: #{dokuman.dosyaTipi.contains('pdf') ? '#dc3545' : 
                                                                                              dokuman.dosyaTipi.contains('word') ? '#2b5797' : 
                                                                                              dokuman.dosyaTipi.contains('excel') ? '#217346' : 
                                                                                              dokuman.dosyaTipi.contains('image') ? '#ffc107' : '#6c757d'};"></i>
                                                        </p:column>
                                                        
                                                        <!-- Dosya Adƒ± -->
                                                        <p:column headerText="Dosya Adƒ±" sortBy="#{dokuman.orijinalDosyaAdi}">
                                                            <h:outputText value="#{dokuman.orijinalDosyaAdi}" 
                                                                         style="font-weight: 500;"/>
                                                        </p:column>
                                                        
                                                        <!-- Dosya Boyutu -->
                                                        <p:column headerText="Boyut" style="width: 100px; text-align: center;">
                                                            <p:badge value="#{dokuman.formattedFileSize}" 
                                                                    severity="info"/>
                                                        </p:column>
                                                        
                                                        <!-- Y√ºklenme Tarihi -->
                                                        <p:column headerText="Y√ºklenme Tarihi" 
                                                                 sortBy="#{dokuman.yuklenmeTarihi}"
                                                                 style="width: 150px;">
                                                            <h:outputText value="#{dokuman.yuklenmeTarihi}">
                                                                <f:convertDateTime pattern="dd.MM.yyyy HH:mm" 
                                                                                  type="localDateTime"
                                                                                  timeZone="Europe/Istanbul"/>
                                                            </h:outputText>
                                                        </p:column>
                                                        
                                                        <!-- Y√ºkleyen -->
                                                        <p:column headerText="Y√ºkleyen" style="width: 120px;">
                                                            <h:outputText value="#{dokuman.yukleyenPersonelAd} #{dokuman.yukleyenPersonelSoyad}"
                                                                         rendered="#{not empty dokuman.yukleyenPersonelAd}"/>
                                                            <span style="color: #999; font-style: italic;" 
                                                                  rendered="#{empty dokuman.yukleyenPersonelAd}">
                                                                Sistem
                                                            </span>
                                                        </p:column>
                                                        
                                                        <!-- ƒ∞≈ülemler -->
                                                        <p:column headerText="ƒ∞≈ülemler" style="width: 80px; text-align: center;">
                                                            <!-- Silme Butonu -->
                                                            <p:commandButton 
                                                                icon="pi pi-trash"
                                                                styleClass="ui-button-danger ui-button-sm"
                                                                action="#{muracaatDokumanController.deleteDokuman(dokuman.id)}"
                                                                update="dokumanTable growl"
                                                                title="Sil">
                                                                <p:confirm header="Onay" 
                                                                          message="Bu dok√ºmanƒ± silmek istediƒüinizden emin misiniz?" 
                                                                          icon="pi pi-exclamation-triangle"/>
                                                            </p:commandButton>
                                                        </p:column>
                                                    </p:dataTable>
                                                </p:panel>
                                                
                                                <!-- Controller'larƒ± Baƒüla -->
                                                <f:event type="preRenderView" 
                                                        listener="#{muracaatDokumanController.setMuracaatIdAndLoad(muracaatController.selectedMuracaat.id)}"
                                                        rendered="#{not empty muracaatController.selectedMuracaat.id}"/>
                                            </h:panelGroup>
                                        </div>
                                    </div>
                                </p:panel>
                                
                               
                                <h:panelGroup id="yardimTalepleriContainer" layout="block">
                                    <p:panel id="yardimTalepleriPanel" 
                                            header="Talep Edilen Yardƒ±mlar" 
                                            style="margin-bottom: 20px;">
                                        <p:outputLabel value="Ba≈üvuru sahibinin talep ettiƒüi yardƒ±mlarƒ± se√ßiniz:" 
                                                     style="display: block; margin-bottom: 15px; font-weight: 500;"/>
                                        
                                        <p:selectManyCheckbox id="yardimTipleri" 
                                                             value="#{muracaatController.selectedYardimTipleri}"
                                                             layout="responsive"
                                                             columns="2"
                                                             onchange="console.log('Yardƒ±m se√ßimi deƒüi≈üti. Se√ßili sayƒ±:', this.querySelectorAll('input:checked').length);">
                                            <f:selectItems value="#{muracaatController.yardimTipleri}" 
                                                          var="yardim"
                                                          itemLabel="#{yardim.adi} (#{yardim.yardimTipi})"
                                                          itemValue="#{yardim.id}"/>
                                        </p:selectManyCheckbox>
                                        
                                        <h:panelGroup rendered="#{empty muracaatController.yardimTipleri}"
                                                      styleClass="ui-message ui-message-warn"
                                                      style="display: block; padding: 10px; border-radius: 4px; margin-top: 10px;">
                                            <h:outputText value="‚ö†Ô∏è Uyarƒ±: Komisyon durumuna g√∂re yardƒ±m tipi bulunmamaktadƒ±r."/>
                                        </h:panelGroup>
                                    
                                    <div style="margin-top: 15px; padding: 10px; background: #FFF3E0; border-left: 4px solid #FF9800; border-radius: 4px;">
                                        <i class="fas fa-info-circle" style="color: #FF9800;"></i>
                                        <strong> Dikkat:</strong>
                                        <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                                            <li><strong>Komisyon Kararlƒ± = EVET:</strong> T√ºm yardƒ±m tipleri g√∂r√ºnt√ºlenir</li>
                                            <li><strong>Komisyon Kararlƒ± = HAYIR:</strong> Sadece komisyonsuz yardƒ±mlar g√∂r√ºnt√ºlenir</li>
                                            <li><strong>NAKDƒ∞ yardƒ±mlar</strong> komisyonsuz verilemez!</li>
                                        </ul>
                                    </div>
                                    </p:panel>
                                </h:panelGroup>
                            </div>
                            
                            <!-- Butonlar -->
                            <div class="card-footer">
                                <p:commandButton value="#{empty muracaatController.selectedMuracaat.id ? 'Kaydet ve Devam Et' : 'G√ºncelle'}" 
                                               icon="#{empty muracaatController.selectedMuracaat.id ? 'pi pi-save' : 'pi pi-check'}" 
                                               styleClass="#{empty muracaatController.selectedMuracaat.id ? 'ui-button-success' : 'ui-button-warning'}"
                                               action="#{muracaatController.saveMuracaat}" 
                                               update=":mainForm:tabView :mainForm:toolbar growl" 
                                               process="basvuruBilgileriPanel"
                                               ajax="true"/>
                                
                                <p:commandButton value="Temizle" 
                                               icon="pi pi-refresh" 
                                               styleClass="ui-button-warning"
                                               action="#{muracaatController.newMuracaat}" 
                                               update="mainForm" 
                                               process="@this"
                                               immediate="true">
                                    <p:confirm header="Onay" 
                                             message="Formu temizlemek istediƒüinizden emin misiniz?" 
                                             icon="pi pi-exclamation-triangle"/>
                                </p:commandButton>
                            </div>
                            </h:panelGroup>
                        </div>
                    </p:tab>
                    
                  
                    <p:tab title="2. Aile Fertleri" 
                          icon="pi pi-users"
                          disabled="#{not muracaatController.muracaatTamamlandi or not muracaatController.komisyonKararli}">
                        <ui:include src="/pages/aile-fertleri.xhtml">
                            <ui:param name="muracaatId" value="#{muracaatController.selectedMuracaat.id}"/>
                            <ui:param name="aileFertController" value="#{aileFertController}"/>
                        </ui:include>
                    </p:tab>
                    
                    
                    <p:tab title="3. Maddi Durum" 
                          icon="pi pi-money-bill"
                          disabled="#{not muracaatController.muracaatTamamlandi or not muracaatController.aileFertGirildi or not muracaatController.komisyonKararli}">
                        <ui:include src="/pages/maddi-durum.xhtml"/>
                    </p:tab>
                    
                   
                    <p:tab title="4. Tahkikat" 
                          icon="pi pi-search"
                          disabled="#{not muracaatController.isTutanakTabEnabled()}">
                        <ui:include src="/pages/tutanak.xhtml"/>
                        <f:event type="preRenderView" listener="#{tutanakController.loadTutanak(muracaatController.selectedMuracaat.id)}"/>
                    </p:tab>
                    
                    
                    <p:tab title="5. Komisyonlu Yardƒ±m Kararlarƒ±" 
                          icon="pi pi-check-circle"
                          disabled="#{empty muracaatController.selectedMuracaat or muracaatController.selectedMuracaat.durum ne 'DEGERLENDIRME_KOMISYONU' or not muracaatController.komisyonKararli}">
                        <ui:include src="/pages/yardim-karar.xhtml"/>
                        <f:event type="preRenderView" listener="#{yardimKararController.loadYardimKararlari(muracaatController.selectedMuracaat.id, true, muracaatController.selectedYardimTipleri)}"/>
                    </p:tab>
                    
                    
                    <p:tab title="6. Komisyonsuz Yardƒ±m Kararlarƒ±" 
                          icon="pi pi-thumbs-up"
                          disabled="#{not muracaatController.muracaatTamamlandi or muracaatController.komisyonKararli}">
                        <ui:include src="/pages/yardim-komisyonsuz.xhtml"/>
                        <f:event type="preRenderView" listener="#{yardimKararController.loadYardimKararlari(muracaatController.selectedMuracaat.id, false, muracaatController.selectedYardimTipleri)}"/>
                    </p:tab>
                </p:tabView>
                </h:panelGroup>
                
                
                <p:dialog id="tumMuracaatlarDialog" 
                         header="üìã M√ºracaatlar (Tamamlanan ve Bekleyen)" 
                         widgetVar="tumMuracaatlarDialogVar"
                         modal="true" 
                         resizable="true" 
                         styleClass="dialog-responsive"
                         width="90%" 
                         height="auto"
                         showEffect="fade" 
                         hideEffect="fade"
                         closable="true"
                         onShow="lockBodyScroll(); aramaInputTemizle();"
                         onHide="unlockBodyScroll()"
                         maximizable="false"
                         responsive="true"
                         fitViewport="true">
                    
                    <!-- Arama B√∂l√ºm√º -->
                    <div style="margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                        
                        <!-- Enter tu≈üu i√ßin RemoteCommand -->
                        <p:remoteCommand name="aramaYap" 
                                        action="#{muracaatController.aramaMuracaatNoIle}"
                                        update="tumMuracaatlarTable"
                                        process="aramaInput"/>
                        
                        <!-- Dialog a√ßƒ±ldƒ±ƒüƒ±nda arama temizle -->
                        <p:remoteCommand name="aramaInputTemizle" 
                                        action="#{muracaatController.aramaInputTemizle}"
                                        update="aramaInput"
                                        process="@this"/>
                        
                        <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <h:outputLabel value="üîç M√ºracaat No:" 
                                         style="font-weight: bold; white-space: nowrap; color: #495057;"/>
                            
                            <p:inputText id="aramaInput" 
                                        value="#{muracaatController.aramaMuracaatNo}" 
                                        placeholder="Tam m√ºracaat numarasƒ±nƒ± giriniz"
                                        style="flex: 0 0 200px; min-width: 150px;"
                                        onkeydown="if(event.keyCode == 13) { event.preventDefault(); aramaYap(); return false; }"/>
                            
                            <p:commandButton id="araBtn"
                                            widgetVar="araBtn"
                                            value="Ara" 
                                            icon="pi pi-search"
                                            styleClass="ui-button-success"
                                            action="#{muracaatController.aramaMuracaatNoIle}"
                                            update="tumMuracaatlarTable"
                                            style="flex: 0 0 auto;"
                                            process="@this,aramaInput"/>
                            
                            <p:commandButton value="T√ºm Liste" 
                                            icon="pi pi-list"
                                            styleClass="ui-button-secondary"
                                            action="#{muracaatController.tumMuracaatlariGetir}"
                                            update="tumMuracaatlarTable,aramaInput"
                                            style="flex: 0 0 auto;"
                                            process="@this"/>
                        </div>
                    </div>
                    
                    <p:dataTable id="tumMuracaatlarTable" 
                                value="#{muracaatController.tumMuracaatlar}" 
                                var="muracaat"
                                emptyMessage="M√ºracaat bulunamadƒ±."
                                paginator="true"
                                rows="7"
                                paginatorPosition="bottom"
                                paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                currentPageReportTemplate="Toplam {totalRecords} m√ºracaat (G√∂sterilen: {startRecord}-{endRecord})"
                                rowsPerPageTemplate="5,7,10"
                                styleClass="custom-datatable compact-table no-scroll-table"
                                responsive="true">
                        
                        <!-- M√ºracaat No -->
                        <p:column headerText="No" sortBy="#{muracaat.muracaatNo}" style="width: 5%;">
                            <h:outputText value="#{muracaat.muracaatNo}" 
                                       style="font-weight: bold; color: #{muracaat.durum eq 'SONUCLANDI' ? '#4CAF50' : '#2196F3'};"/>
                        </p:column>
                        
                        <!-- Ba≈üvuru Sahibi -->
                        <p:column headerText="Ba≈üvuru Sahibi" sortBy="#{muracaat.basvuruSahibi.ad}" style="width: 20%;">
                            <h:outputText value="#{muracaat.basvuruSahibi.ad} #{muracaat.basvuruSahibi.soyad}"/>
                        </p:column>
                        
                        <!-- TC Kimlik No -->
                        <p:column headerText="TC No" style="width: 12%;">
                            <h:outputText value="#{muracaat.basvuruSahibi.tcKimlikNo}"/>
                        </p:column>
                        
                        <!-- M√ºracaat Tarihi -->
                        <p:column headerText="Tarih" sortBy="#{muracaat.muracaatTarihi}" style="width: 12%;">
                            <h:outputText value="#{muracaat.muracaatTarihi}">
                                <f:convertDateTime pattern="dd.MM.yy" type="localDate"/>
                            </h:outputText>
                        </p:column>
                        
                        <!-- Durum -->
                        <p:column headerText="Durum" style="width: 12%;">
                            <p:badge value="#{muracaat.durum.label}" 
                                   severity="#{muracaat.durum eq 'SONUCLANDI' ? 'success' : 'warning'}"/>
                        </p:column>
                        
                        <!-- Komisyon Kararlƒ± mƒ±? -->
                        <p:column headerText="Komisyon" style="width: 10%;">
                            <p:badge value="#{muracaat.komisyonKararli ? 'Evet' : 'Hayƒ±r'}" 
                                   severity="#{muracaat.komisyonKararli ? 'info' : 'secondary'}"/>
                        </p:column>
                        
                        <!-- ƒ∞≈ülemler -->
                        <p:column headerText="ƒ∞≈ülemler" style="width: 12%; text-align: center;">
                            <!-- Sonu√ßlanmƒ±≈ü m√ºracaatlar i√ßin detay g√∂r√ºnt√ºleme -->
                            <p:commandButton icon="pi pi-eye" 
                                           styleClass="ui-button-info ui-button-sm icon-only-btn"
                                           action="#{muracaatController.showMuracaatDetay(muracaat)}"
                                           process="@this"
                                           update=":mainForm:muracaatDetayDialog"
                                           oncomplete="PF('muracaatDetayDialog').show(); $('body').css('overflow', 'hidden');"
                                           title="Detay G√∂r√ºnt√ºle"
                                           rendered="#{muracaat.durum eq 'SONUCLANDI'}"
                                           style="margin-right: 3px;"/>
                            
                            <!-- Sonu√ßlanmƒ±≈ü m√ºracaatlar i√ßin rapor butonu -->
                            <h:outputLink value="javascript:void(0)" 
                                        onclick="downloadMuracaatRapor(#{muracaat.id});"
                                        rendered="#{muracaat.durum eq 'SONUCLANDI'}"
                                        style="margin-left: 3px;">
                                <i class="pi pi-file-pdf" 
                                   style="color: #dc3545; padding: 6px; border: 1px solid #dc3545; border-radius: 4px; background: white;"
                                   title="M√ºracaat Raporu ƒ∞ndir"></i>
                            </h:outputLink>
                            
                            <!-- Devam eden m√ºracaatlar i√ßin devam etme -->
                            <p:commandButton icon="pi pi-play" 
                                           styleClass="ui-button-success ui-button-sm icon-only-btn"
                                           action="#{muracaatController.muracaataDevamEt(muracaat)}"
                                           update="mainForm growl"
                                           process="@this"
                                           oncomplete="PF('tumMuracaatlarDialogVar').hide();"
                                           title="Kaldƒ±ƒüƒ±nƒ±z yerden devam edin"
                                           rendered="#{muracaat.durum ne 'SONUCLANDI'}">
                                <p:confirm header="Onay" 
                                          message="Bu m√ºracaata devam etmek istediƒüinizden emin misiniz?" 
                                          icon="pi pi-exclamation-triangle"/>
                            </p:commandButton>
                            
                            <p:commandButton icon="pi pi-times" 
                                           styleClass="ui-button-danger ui-button-sm icon-only-btn"
                                           action="#{muracaatController.muracaatiIptalEt(muracaat)}"
                                           update="tumMuracaatlarTable growl"
                                           process="@this"
                                           rendered="#{muracaat.durum eq 'BEKLEMEDE'}"
                                           title="M√ºracaatƒ± ƒ∞ptal Et">
                                <p:confirm header="Onay" 
                                          message="Bu m√ºracaata iptal etmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!" 
                                          icon="pi pi-exclamation-triangle"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                    
                    <p:separator/>
                    
                    <p:commandButton value="Kapat" 
                                   icon="pi pi-times" 
                                   styleClass="ui-button-secondary"
                                   onclick="PF('tumMuracaatlarDialogVar').hide()"
                                   style="float: right;"/>
                </p:dialog>
                
                <!-- M√ºracaat Detay Modal -->
                <p:dialog id="muracaatDetayDialog" 
                         header="üìÑ M√ºracaat Detaylarƒ±" 
                         widgetVar="muracaatDetayDialog"
                         modal="true" 
                         resizable="true" 
                         styleClass="dialog-responsive"
                         width="80%" 
                         height="80%"
                         maximizable="true"
                         closable="true"
                         dynamic="true"
                         onHide="$('body').css('overflow', 'auto');">
                    
                    <h:panelGroup id="muracaatDetayContent" rendered="#{muracaatController.detayMuracaat ne null}" style="max-height: 60vh; overflow-y: auto; overflow-x: hidden; display: block; position: relative;"
                                   onclick="event.stopPropagation()"
                                   onwheel="event.stopPropagation()">
                        <div class="card" style="margin: 0;">
                        <!-- M√ºracaat Bilgileri -->
                        <div class="card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px;">
                            <h3 style="margin: 0; display: flex; align-items: center;">
                                <i class="pi pi-file-text" style="margin-right: 10px;"></i>
                                M√ºracaat Bilgileri
                            </h3>
                        </div>
                        
                        <div class="card-body" style="padding: 20px;">
                            <div class="form-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <strong>M√ºracaat No:</strong>
                                    <h:outputText value="#{muracaatController.detayMuracaat.muracaatNo}" 
                                                 style="display: block; margin-top: 5px; color: #2c3e50; font-weight: bold;"/>
                                </div>
                                
                                <div>
                                    <strong>Durum:</strong>
                                    <p:badge value="#{muracaatController.detayMuracaat.durum.label}" 
                                            severity="success" 
                                            style="display: block; margin-top: 5px;"/>
                                </div>
                                
                                <div>
                                    <strong>Karar No:</strong>
                                    <h:outputText value="#{muracaatController.detayMuracaat.kararNo ne null ? muracaatController.detayMuracaat.kararNo : 'Yok'}" 
                                                 style="display: block; margin-top: 5px; color: #2c3e50;"/>
                                </div>
                                
                                <div>
                                    <strong>Karar Tarihi:</strong>
                                    <h:outputText value="#{muracaatController.detayMuracaat.kararTarihi ne null ? muracaatController.detayMuracaat.kararTarihi : 'Yok'}" 
                                                 style="display: block; margin-top: 5px; color: #2c3e50;">
                                        <f:convertDateTime pattern="dd.MM.yyyy" type="localDate"/>
                                    </h:outputText>
                                </div>
                                
                                <div>
                                    <strong>Komisyon Kararlƒ±:</strong>
                                    <p:badge value="#{muracaatController.detayMuracaat.komisyonKararli ? 'Evet' : 'Hayƒ±r'}" 
                                            severity="#{muracaatController.detayMuracaat.komisyonKararli ? 'info' : 'secondary'}" 
                                            style="display: block; margin-top: 5px;"/>
                                </div>
                                
                                <div>
                                    <strong>Kendisi Ba≈üvurdu:</strong>
                                    <p:badge value="#{muracaatController.detayMuracaat.kendisiBasvurdu ? 'Evet' : 'Hayƒ±r'}" 
                                            severity="#{muracaatController.detayMuracaat.kendisiBasvurdu ? 'success' : 'warning'}" 
                                            style="display: block; margin-top: 5px;"/>
                                </div>
                            </div>
                            
                            <!-- Ba≈üvuru Metni -->
                            <div style="margin-bottom: 20px;" rendered="#{not empty muracaatController.detayMuracaat.basvuruMetnu}">
                                <strong>Ba≈üvuru Metni:</strong>
                                <div style="margin-top: 10px; padding: 15px; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 5px;">
                                    <h:outputText value="#{muracaatController.detayMuracaat.basvuruMetnu}" 
                                                 style="white-space: pre-wrap; line-height: 1.6;"/>
                                </div>
                            </div>
                            
                            <!-- Personel G√∂r√º≈ü Notu -->
                            <div style="margin-bottom: 20px;" rendered="#{not empty muracaatController.detayMuracaat.personelGorusNotu}">
                                <strong>Personel G√∂r√º≈ü Notu:</strong>
                                <div style="margin-top: 10px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px;">
                                    <h:outputText value="#{muracaatController.detayMuracaat.personelGorusNotu}" 
                                                 style="white-space: pre-wrap; line-height: 1.6;"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Verilen Yardƒ±mlar -->
                    <div class="card" style="margin: 20px 0 0 0;">
                        <div class="card-header" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 15px;">
                            <h4 style="margin: 0; display: flex; align-items: center;">
                                <i class="pi pi-gift" style="margin-right: 10px;"></i>
                                Verilen Yardƒ±mlar
                            </h4>
                        </div>
                        
                        <div class="card-body" style="padding: 0;">
                            <p:dataTable value="#{muracaatController.detayYardimKararlari}" 
                                        var="karar" 
                                        styleClass="ui-datatable-striped"
                                        paginator="false"
                                        scrollable="false"
                                        responsive="true"
                                        emptyMessage="Bu m√ºracaata ait yardƒ±m kararƒ± bulunmamaktadƒ±r.">
                                
                                <p:column headerText="Yardƒ±m Tipi" style="width: 200px;">
                                    <h:outputText value="#{karar.yardimAltTipi.adi}"/>
                                </p:column>
                                
                                <p:column headerText="Durum" style="width: 120px;">
                                    <p:badge value="#{karar.yardimDurum.label}" 
                                            severity="#{karar.yardimDurum eq 'KABUL_EDILDI' ? 'success' : 'danger'}"/>
                                </p:column>
                                
                                <p:column headerText="Verilen Tutar" style="width: 120px;">
                                    <h:outputText value="#{karar.verilenTutar ne null ? karar.verilenTutar : '-'}" 
                                                 rendered="#{karar.verilenTutar ne null}">
                                        <f:convertNumber type="currency" currencySymbol="‚Ç∫"/>
                                    </h:outputText>
                                    <h:outputText value="-" rendered="#{karar.verilenTutar eq null}"/>
                                </p:column>
                                
                                <p:column headerText="Adet/Sayƒ±" style="width: 100px;">
                                    <h:outputText value="#{karar.adetSayi ne null ? karar.adetSayi : '-'}"/>
                                </p:column>
                                
                                <p:column headerText="Kesinle≈üti" style="width: 100px;">
                                    <p:badge value="#{karar.kesinlesti ? 'Evet' : 'Hayƒ±r'}" 
                                            severity="#{karar.kesinlesti ? 'success' : 'warning'}"/>
                                </p:column>
                                
                                <p:column headerText="A√ßƒ±klama" style="width: 200px;">
                                    <h:outputText value="#{karar.aciklama ne null ? karar.aciklama : '-'}" 
                                                 style="font-size: 12px; max-width: 180px; display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                                                 title="#{karar.aciklama}"/>
                                </p:column>
                            </p:dataTable>
                        </div>
                    </div>
                    </h:panelGroup>
                    
                    <p:separator style="margin-top: 20px;"/>
                    
                    <div style="text-align: right; padding: 10px;">
                        <p:commandButton value="Kapat" 
                                       icon="pi pi-times" 
                                       styleClass="ui-button-secondary"
                                       onclick="PF('muracaatDetayDialog').hide()"/>
                    </div>
                </p:dialog>
                
                <p:confirmDialog global="true">
                    <p:commandButton value="Evet" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check"/>
                    <p:commandButton value="Hayƒ±r" type="button" styleClass="ui-confirmdialog-no ui-button-secondary" icon="pi pi-times"/>
                </p:confirmDialog>
        </div> <!-- End content-body -->
        </h:form>
    </ui:define>
    
</ui:composition>
</html>
 